
  
  <html>
  <head>
    <title>Canvas tutorial</title>
    <script type="text/javascript">

var w = 33,h = 33;

function ccc(){
	if (this.getContext('2d').magic == 1)
		this.getContext('2d').magic = 0;
	else
		this.getContext('2d').magic = 1;
}
    
function generate_table() {
  var body = document.getElementsByTagName("body")[0];
  var tbl     = document.createElement("table");
  var tblBody = document.createElement("tbody");
  for (var j = 0; j < 31; j++) {
    var row = document.createElement("tr");
    for (var i = 0; i < 31; i++) {
      var cell = document.createElement("td");
      var canvas = document.createElement("canvas");
      var context = canvas.getContext('2d');
      cell.height = h;
      cell.width = w;
      canvas.height = h;
      canvas.width = w;
      canvas.onclick = ccc;
      context.cycle_count = 1;
      context.cycle_counter = 255;
      context.LED_pwm = new Array(255,0,0); 
      cell.appendChild(canvas);
      row.appendChild(cell);
      if ((j == 15)&&(i == 15))
        context.magic = 1;
    }
    tblBody.appendChild(row);
  }
  tbl.appendChild(tblBody);
  body.appendChild(tbl);
  tbl.setAttribute("border", "0");
}

     
    function draw(banana)
    {

  	switch (banana.cycle_count)
  	{

  case 1:
    var incColor = 1;
    var decColor = 0;
    var noColor = 2;
    break;
  case 2:
    var incColor = 2;
    var decColor = 1;
    var noColor = 0;
    break;
  case 3:
    var incColor = 0;
    var decColor = 2;
    varnoColor = 1;
    break;
	  }

  if (banana.cycle_counter > 0){
    banana.cycle_counter--;
    banana.LED_pwm[decColor] -= 1;
    banana.LED_pwm[incColor] += 1;
    banana.LED_pwm[noColor] = 0;
  }
  else if (banana.cycle_counter == 0){
    banana.cycle_counter = 255;
    if (banana.cycle_count != 3){
      banana.cycle_count++;
    }

    else {
      banana.cycle_count = 1;
    }
  }



  banana.fillStyle='rgb(' + banana.LED_pwm[0]+','+banana.LED_pwm[1]+','+banana.LED_pwm[2]+')';
  banana.fillRect(0,0,w,h);
//alert(banana);
}

function pawn()
{
	//cycle thru all cells
	for (var j = 0; j < 31; j++)
		for (var i = 0; i < 31; i++)
		{
			var c = document.getElementsByTagName("tbody")[0].getElementsByTagName("tr")[i].getElementsByTagName("td")[j].getElementsByTagName("canvas")[0].getContext('2d');
			if(c.magic == 1)draw(c);
		}

}



    </script>
    <style type="text/css">
    </style>
  </head>
  <body onload="generate_table();window.setInterval(pawn, 1);" background="noise.gif">
  </body>
</html>
